<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>后台管理系统</title>

    <!-- Bootstrap core CSS -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/static/css/offcanvas.css" rel="stylesheet">
    {% block manager_register_css %}{% endblock %}
    <script src="/static/js/respond.min.js"></script>


    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]>
    <script src="/static/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="/static/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/static/js/html5shiv.min.js"></script>
    <![endif]-->

</head>

<body>
<nav class="navbar navbar-fixed-top navbar-inverse">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                    aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="{% url 'index' %}">后台管理系统</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="active"><a href="{% url 'index' %}">首页</a></li>
                <li><a href="{% url 'about' %}">关于</a></li>
                <li><a href="{% url 'contact' %}">联系</a></li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    {% if flag %}
                    <p class="text-muted btn dropdown-toggle" data-toggle="dropdown">欢迎您：{{login_user}}<span
                            class="caret"></span></p>
                    <ul class="dropdown-menu">
                        <li><a href="{% url 'admin_logout' %}">注销</a></li>
                    </ul>
                    {% else %}
                    <p class="text-muted btn dropdown-toggle" data-toggle="dropdown">亲爱的管理员，您还未登录哦<span
                            class="caret"></span></p>
                    <ul class="dropdown-menu">
                        <li><a href="{% url 'req_admin_login' %}">登录</a></li>
                        <li><a href="{% url 'req_admin_register' %}">注册</a></li>
                        <li><a href="{% url 'admin_logout' %}">注销</a></li>
                    </ul>
                    {% endif %}
                </li>
            </ul>
        </div>
        <!-- /.nav-collapse -->
    </div>
    <!-- /.container -->
</nav>
<!-- /.navbar -->

{% block page_container %}
<div class="container">

    <div class="row row-offcanvas row-offcanvas-right">

        <div class="col-xs-12 col-sm-9">
            <p class="pull-right visible-xs">
                <button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Toggle nav</button>
            </p>
            <div class="jumbotron">
                <h2>欢迎来到后台管理系统</h2>

                <p class="text-danger">如果想要使用本系统所提供的美妙功能的话，请先使用管理员帐号登录。如果没有帐号的话，请先注册。如果既不登录又不注册的话，NMB，请滚蛋^_^</p>
            </div>

            {% if flag %}
            <div class="row">
                {% block content %}
                <div class="col-xs-14 col-lg-24">
                    <h2>商品列表</h2>
                    <table class="table table-hover">
                        <thead>
                        <tr>
                            <th></th>
                            <th>
                                <small>商品名称</small>
                            </th>
                            <th>
                                <small>商品价格</small>
                            </th>
                            <th>
                                <small>商品介绍</small>
                            </th>
                            <th>
                                <small>商品邮费</small>
                            </th>
                            <th>
                                <small>剩余商品个数</small>
                            </th>
                            <th>
                                <small>商品图片</small>
                            </th>
                            <th>
                                <small>商品信息</small>
                            </th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for commodity in commoditys_list %}
                        <tr>
                            <td><input type="checkbox" name="del_commoditys" id="{{ commodity.c_id }}"></td>
                            <td>
                                <small>{{ commodity.c_name }}</small>
                            </td>
                            <td>
                                <small>{{ commodity.c_price }}</small>
                            </td>
                            <td>
                                <div id="div_{{ commodity.c_id }}" style="display: none">
                                    {{ commodity.c_description }}
                                </div>
                                <a href="javascript:void(0)" class="check_info_1" myvalue="{{ commodity.c_id }}"><small>详情</small></a>
                            </td>
                            <td>
                                <small>{{ commodity.c_postage }}</small>
                            </td>
                            <td>
                                <small>{{ commodity.c_num }}</small>
                            </td>
                            <td>
                                <div id="img_{{ commodity.c_id }}" style="display: none">
                                    <img src="/static/files/commodity_imgs/{{ commodity.c_id }}.png"/>
                                </div>
                                <a href="javascript:void(0)" class="check_info_2" myvalue="{{ commodity.c_id }}"><small>详情</small></a>
                            </td>
                            <td>
                                <div id="info_{{ commodity.c_id }}" style="display: none">
                                    <table class="table table-hover">
                                        <thead>
                                        <tr>
                                            <th><small>所属品牌</small></th>
                                            <th><small>所属类别</small></th>
                                            <th><small>提供的尺寸</small></th>
                                            <th><small>提供的颜色/款式</small></th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td><small>{{ commodity.c_brand }}</small></td>
                                            <td><small>{{ commodity.c_class }}</small></td>
                                            <td><small>{{ commodity.c_size }}</small></td>
                                            <td><small>{{ commodity.c_style }}</small></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <a href="javascript:void(0)" class="check_info_3" myvalue="{{ commodity.c_id }}"><small>详情</small></a>
                            </td>
                            <td><p><a class="btn btn-default btn-sm"
                                      href="{% url 'req_modify_commodity' %}?cid={{ commodity.c_id }}" role="button">修改商品</a>
                            </p></td>
                        </tr>
                        {% endfor %}
                        <div class="test">
                            <p id="info" style="line-height:2;text-indent:1.2em;"></p>
                        </div>
                        </tbody>
                    </table>
                    <a class="btn btn-default  btn-sm" href="javascript:void(0);" onclick="del_items()"
                       role="button">删除选中的商品</a>
                    <a class="btn btn-default  btn-sm" href="{% url 'req_add_commodity' %}" role="button">添加商品</a>
                </div>

                <!--<div class="col-xs-6 col-lg-4">-->
                <!--<h2>Heading</h2>-->

                <!--<p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor-->
                <!--mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada-->
                <!--magna mollis euismod. Donec sed odio dui. </p>-->

                <!--<p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>-->
                <!--</div>-->
                <!--<!--/.col-xs-6.col-lg-4-->-->
                <!--<div class="col-xs-6 col-lg-4">-->
                <!--<h2>Heading</h2>-->

                <!--<p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor-->
                <!--mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada-->
                <!--magna mollis euismod. Donec sed odio dui. </p>-->

                <!--<p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>-->
                <!--</div>-->
                {% endblock %}
            </div>
            <!--/row-->

        </div>
        <!--/.col-xs-12.col-sm-9-->
        {% block options %}
        <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar">
            <div class="list-group">
                <a href="{% url 'index' %}" class="list-group-item active">商品管理</a>
                <a href="{% url 'req_brand' %}" class="list-group-item">品牌管理</a>
                <a href="{% url 'req_class' %}" class="list-group-item">分类管理</a>
                <a href="{% url 'req_style' %}" class="list-group-item">颜色/款式管理</a>
                <a href="{% url 'req_size' %}" class="list-group-item">尺寸管理</a>
                <a href="#" class="list-group-item">订单管理</a>
                <a href="#" class="list-group-item">发货管理</a>
                <a href="{% url 'req_shop_addr' %}" class="list-group-item">门店管理</a>
                <a href="{% url 'req_admin' %}" class="list-group-item">管理员管理</a>
                <a href="{% url 'req_client' %}" class="list-group-item">会员管理</a>
            </div>
        </div>
        <!--/.sidebar-offcanvas-->
        {% endblock %}
    </div>
    <!--/row-->
    {% endif %}
    <hr>

    <footer>
        <p>&copy; Company 2014</p>
    </footer>

</div>
<!--/.container-->
{% endblock %}

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="/static/js/jquery.min.js"></script>
<script src="/static/js/bootstrap.min.js"></script>

<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="/static/js/ie10-viewport-bug-workaround.js"></script>

<script src="/static/js/offcanvas.js"></script>

{% block manager_register_login_options_js %}
{{ message|safe }} <!--加上safe后防止标签转义-->
<link rel="stylesheet" href="/static/css/fbmodal.css"/>
<script src="/static/js/jquery.fbmodel.js"></script>
<script type="text/javascript">
    $(function () {
        $(".check_info_1").click(function () {
            var myvalue = $(this).attr("myvalue");
            var myid = "div_" + myvalue;
            var text = document.getElementById(myid).innerHTML;
            document.getElementById("info").innerHTML = text;

            $(".test").fbmodal({
                okaybutton: true,
                cancelbutton: false,
                buttons: true,
                opacity: 0.35,
                fadeout: true,
                overlayclose: true,
                modaltop: "30%",
                modalwidth: "400"
            });
        });
        $(".check_info_2").click(function () {
            var myvalue = $(this).attr("myvalue");
            var myid = "img_" + myvalue;
            var text = document.getElementById(myid).innerHTML;
            document.getElementById("info").innerHTML = text;

            $(".test").fbmodal({
                okaybutton: true,
                cancelbutton: false,
                buttons: true,
                opacity: 0.35,
                fadeout: true,
                overlayclose: true,
                modaltop: "30%",
                modalwidth: "800"
            });
        });
        $(".check_info_3").click(function () {
            var myvalue = $(this).attr("myvalue");
            var myid = "info_" + myvalue;
            var text = document.getElementById(myid).innerHTML;
            document.getElementById("info").innerHTML = text;

            $(".test").fbmodal({
                okaybutton: true,
                cancelbutton: false,
                buttons: true,
                opacity: 0.35,
                fadeout: true,
                overlayclose: true,
                modaltop: "30%",
                modalwidth: "400"
            });
        });
    });
    function del_items() {
        if (window.confirm("您确定要删除吗？")) {
            //var username = "{{login_user}}";
            var url = "/manage/delete_items/";
            var i = 0;
            var deleList = new Array();
            $("input[name='del_commoditys']:checked").each(function () {
                i++;
                deleList[i] = $(this).attr('id');
            });
            $.post(url,
                    {
                        del_object: 'commodity',
                        del_item_list: deleList.toString()
                    }, function (data) {
                        for (var i = 1; i < deleList.length; i++) {
                            var del_node = document.getElementById(deleList[i]);
                            var del_tr = del_node.parentNode.parentNode;
                            del_tr.parentNode.removeChild(del_tr);
                        }
                        var del_box_list = document.getElementsByName("del_commoditys");
                        for (var i = 0; i < del_box_list.length; i++) {
                            del_box_list[i].checked = false;
                        }
                        alert(data);
                    });
        }
    }
</script>
{% endblock %}
</body>
</html>
